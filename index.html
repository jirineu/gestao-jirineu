<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GestaoVendasNaturalJirineu</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
    <div id="modalLogin" style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:9999; display:flex; align-items:center; justify-content:center; font-family: sans-serif; color: #333;">
    <div style="background:white; padding:30px; border-radius:15px; max-width:400px; width:90%; text-align:center; box-shadow: 0 10px 25px rgba(0,0,0,0.5);">
        <h2 style="margin-bottom: 10px; color: #2e7d32;">üåø Gest√£o Jirineu</h2>
        <p style="margin-bottom: 25px; color: #666; font-size: 14px;">Selecione o modo de acesso</p>

        <div id="loginOpcoes">
            <button onclick="mostrarCamposAdmin()" style="width:100%; padding:15px; margin-bottom:15px; border:none; border-radius:8px; background:#2e7d32; color:white; font-weight:bold; cursor:pointer; font-size: 16px;">üîë Entrar com Senha</button>
            <button onclick="confirmarLoginVisita()" style="width:100%; padding:15px; border:2px solid #2e7d32; border-radius:8px; background:white; color:#2e7d32; font-weight:bold; cursor:pointer; font-size: 16px;">üëÅÔ∏è Modo Visitante (Demo)</button>
        </div>

        <div id="loginAdminCampos" style="display:none;">
            <div style="text-align: left; margin-bottom: 15px;">
                <label style="font-size: 12px; font-weight: bold; color: #444;">NOME DE UTILIZADOR</label>
                <input type="text" id="userLogin" placeholder="Ex: admin ou vendedor" style="width:100%; padding:12px; margin-top:5px; border:1px solid #ccc; border-radius:5px; box-sizing: border-box;">
            </div>
            <div style="text-align: left; margin-bottom: 20px;">
                <label style="font-size: 12px; font-weight: bold; color: #444;">PALAVRA-PASSE</label>
                <input type="password" id="senhaAdmin" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" style="width:100%; padding:12px; margin-top:5px; border:1px solid #ccc; border-radius:5px; box-sizing: border-box;">
            </div>
            
            <button onclick="validarAdmin()" style="width:100%; padding:15px; border:none; border-radius:8px; background:#2e7d32; color:white; font-weight:bold; cursor:pointer; margin-bottom: 10px;">Confirmar Acesso</button>
            <button onclick="voltarOpcoes()" style="background:none; border:none; color:#666; cursor:pointer; text-decoration:underline; font-size: 13px;">Voltar</button>
        </div>
    </div>
</div>
    <main id="app-container">
        <section id="screen-dash" class="screen active">
            <h2 class="section-title">üìä Dashboard</h2>
            <div class="card">
                <label for="dash-periodo">Filtrar Per√≠odo</label>
                <select id="dash-periodo" class="custom-select" onchange="atualizarDash()">
                    <option value="7">√öltimos 7 dias</option>
                    <option value="15">√öltimos 15 dias</option>
                    <option value="30" selected>√öltimos 30 dias</option>
                    <option value="90">√öltimos 90 dias</option>
                </select>

                <div class="stats-grid">
                    <div class="stat-box">
                        <span class="stat-label">Vendas</span>
                        <h3 id="dash-vendas-total">R$ 0,00</h3>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Itens</span>
                        <h3 id="dash-itens-total">0</h3>
                    </div>
                </div>

                <div class="chart-container" style="position: relative; height:220px;">
                    <canvas id="meuGrafico"></canvas>
                </div>

                <div class="stats-grid financial-grid" style="margin-top: 20px;">
                    <div class="stat-box" style="border-top: 4px solid #3498db;">
                        <span class="stat-label">Investimento em Estoque</span>
                        <h3 id="dash-custo-estoque" style="font-size: 1.1rem;">R$ 0,00</h3>
                    </div>
                    <div class="stat-box" style="border-top: 4px solid #27ae60;">
                        <span class="stat-label">Valor de Venda</span>
                        <h3 id="dash-venda-estoque" style="font-size: 1.1rem;">R$ 0,00</h3>
                    </div>
                </div>
                
                <div class="stat-box-full" style="padding: 12px; background: #ebf9f1; border-radius: 8px; border-left: 4px solid #2ecc71; margin-bottom: 20px;">
                    <span class="info-sub" style="color: #27ae60; font-weight: bold;">üí∞ Lucro Bruto Previsto (Estoque):</span>
                    <div id="dash-lucro-previsto" class="info-main" style="font-size: 1.3rem; color: #1e8449;">R$ 0,00</div>
                </div>

                <div id="dash-stats-extras" style="margin-top: 20px; border-top: 1px solid #eee; padding-top: 15px;">
                    <div class="stat-box-full" style="margin-bottom: 10px; padding: 12px; background: #fffcf5; border-radius: 8px; border-left: 4px solid #f1c40f;">
                        <span class="info-sub" style="color: #967d09; font-weight: bold;">‚≠ê Produto Mais Vendido (Per√≠odo):</span>
                        <div id="dash-prod-top" class="info-main" style="margin-top: 4px;">-</div>
                    </div>

                    <div class="stat-box-full" style="margin-bottom: 10px; padding: 12px; background: #f5faff; border-radius: 8px; border-left: 4px solid #3498db;">
                        <span class="info-sub" style="color: #2980b9; font-weight: bold;">üë§ Melhor Cliente (Acumulado):</span>
                        <div id="dash-cliente-top" class="info-main" style="margin-top: 4px;">-</div>
                    </div>

                    <div class="stat-box-full" style="margin-bottom: 10px; padding: 12px; background: #fff5f5; border-radius: 8px; border-left: 4px solid var(--danger);">
                        <span class="info-sub" style="color: #c0392b; font-weight: bold;">‚ö†Ô∏è Estoque Cr√≠tico:</span>
                        <div id="dash-estoque-critico" class="info-main" style="color: var(--danger); margin-top: 4px;">0 produtos</div>
                    </div>

                    <div class="stat-box-full" style="padding: 12px; background: #f9f9f9; border-radius: 8px;">
                        <span class="info-sub" style="font-weight: bold;">üßä Menos Movimentados (10):</span>
                        <div id="dash-menos-movimentados" class="info-sub" style="font-size: 0.85rem; margin-top: 8px; line-height: 1.5;">-</div>
                    </div>
                </div>
            </div>
        </section>

        <section id="screen-add" class="screen">
            <h2 class="section-title" id="titulo-form">‚ûï Novo Produto</h2>
            <div class="card form-card">
                <input type="hidden" id="p-id">
                <div class="input-group">
                    <label>Nome do Tempero</label>
                    <input type="text" id="p-nome" placeholder="Ex: P√°prica Defumada">
                </div>
                <div class="row">
                    <div class="input-group">
                        <label>Custo/KG (R$)</label>
                        <input type="number" id="p-custo" placeholder="0.00" step="0.01">
                    </div>
                    <div class="input-group">
                        <label>Gramas/Un</label>
                        <input type="number" id="p-gramas" placeholder="50">
                    </div>
                </div>
                <div class="price-badge">
                    <small>Pre√ßo Padr√£o (Base Config):</small>
                    <span id="p-sugerido">R$ 0,00</span>
                </div>
                <div class="input-group">
                    <label>Pre√ßo de Venda Final (R$)</label>
                    <input type="number" id="p-venda" class="highlight-input" step="0.01">
                </div>
                <div class="input-group">
                    <label>Observa√ß√µes</label>
                    <textarea id="p-obs" rows="2" placeholder="Ex: Fornecedor, validade..."></textarea>
                </div>
                <button class="btn btn-save" onclick="salvarProduto()">üíæ Salvar Produto</button>
                <button id="btn-cancelar" class="btn btn-cancel" style="display:none; margin-top: 10px;" onclick="cancelarEdicao()">Cancelar Edi√ß√£o</button>
            </div>
        </section>

        <section id="screen-lista" class="screen">
            <h2 class="section-title">üìù Produ√ß√£o / Compras</h2>
            <div class="card">
                <div class="input-group">
                    <label>Selecionar Produto</label>
                    <select id="li-produto-select" class="custom-select"></select>
                </div>
                <div class="row">
    <div class="input-group">
        <label>Gramas Compradas</label>
        <input type="number" id="li-qtd-gramas" placeholder="Ex: 1000">
    </div>
    <div class="input-group">
        <label>Para quem? (Opcional)</label>
        <input type="text" id="li-destinatario" placeholder="Ex: Jo√£o">
    </div>
</div>
<button class="btn btn-save" style="margin-top: 10px;" onclick="adicionarNaLista()">Adicionar na Lista</button>
            </div>
            <div id="lista-compras-pendentes" class="list-container"></div>
        </section>

        <section id="screen-estoque" class="screen">
            <div class="header-vendas">
                <h2 class="section-title">üì¶ Estoque</h2>
                <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                    <button class="btn-report" style="background: var(--success);" onclick="showScreen('add')">‚ûï Novo</button>
                    <button class="btn-report" style="background: #2980b9;" onclick="abrirPainelInventario()">üìù Inv.</button>
                    <button class="btn-report" onclick="gerarRelatorioPDF()">üìã PDF</button>
                </div>
            </div>
            <div class="search-box">
                <input type="text" id="busca-estoque" placeholder="üîç Pesquisar tempero..." onkeyup="listarEstoque()">
            </div>
            <div id="lista-estoque" class="list-container"></div>
        </section>

        <section id="screen-inventario" class="screen">
            <h2 class="section-title">üìù Atualizar Invent√°rio</h2>
            <div class="card">
                <div class="input-group">
                    <label>Produto</label>
                    <select id="inv-produto-select" class="custom-select"></select>
                </div>
              <div class="input-group">
    <label>Nova Quantidade Real (em Gramas)</label>
    <input type="number" id="inv-nova-qtd-gramas" placeholder="Ex: 500 para 0,5kg">
</div>  
                <button class="btn btn-save" onclick="salvarInventario()">üíæ Atualizar Estoque</button>
                <button class="btn btn-cancel" style="margin-top:10px" onclick="showScreen('estoque')">Voltar</button>
            </div>
        </section>

        <section id="screen-vendas" class="screen">
            <div class="header-vendas">
                <h2 class="section-title">üí∞ Vendas</h2>
                <button class="btn-action" onclick="abrirNovaVenda()">Nova Venda</button>
            </div>
            <div class="search-box">
                <input type="text" id="busca-venda" placeholder="üîç Cliente ou Data..." onkeyup="listarVendas()">
            </div>
            <div id="lista-vendas-realizadas" class="list-container"></div>
        </section>

        <section id="screen-nova-venda" class="screen">
            <h2 class="section-title">üõí Nova Venda</h2>
            <div class="card">
                <div class="input-group">
                    <label>Nome do Cliente</label>
                    <input type="text" id="v-cliente-nome" placeholder="Opcional">
                </div>
                <div class="cart-selector" style="background: #f9f9f9; padding: 10px; border-radius: 8px;">
                    <label>Produto</label>
                    <select id="v-produto-select" class="custom-select" style="margin-bottom: 10px;"></select>
                    <div class="row">
                        <input type="number" id="v-qtd" value="1" min="1" style="flex: 1;">
                        
                        <button class="btn btn-save" style="flex: 2;" onclick="adicionarAoCarrinho()">Adicionar</button>
                    </div>
                </div>
                <div id="carrinho-itens" style="margin:20px 0; border-bottom: 1px dashed #ccc;"></div>
                <div class="cart-total" style="display: flex; justify-content: space-between; font-size: 1.2rem; margin-bottom: 20px;">
                    <span>Total:</span>
                    <strong id="v-total-carrinho" style="color: var(--success);">R$ 0,00</strong>
                </div>
                <div class="input-group" style="margin-top: 15px;">
    <label>Situa√ß√£o do Pagamento</label>
    <select id="v-status-pagamento" class="custom-select">
        <option value="pago" selected>‚úÖ Pago </option>
        <option value="devedor">‚è≥ Devedor </option>
    </select>
</div>
                <button class="btn btn-save" onclick="finalizarVenda()">‚úÖ Finalizar Venda</button>
                <button class="btn btn-cancel" style="margin-top:10px" onclick="showScreen('vendas')">Cancelar</button>
            </div>
        </section>

        <section id="screen-config" class="screen">
            <h2 class="section-title">‚öôÔ∏è Configura√ß√µes</h2>
            <div class="card">
                <div class="input-group">
                    <label>Pre√ßo de Venda Padr√£o (R$)</label>
                    <input type="number" id="cfg-valor-fixo" step="0.01">
                </div>
                <button class="btn btn-save" onclick="salvarConfig()">Salvar Ajuste</button>
            </div>
            <div class="card" style="margin-top: 20px;">
                <label>üì¶ Gerenciar Dados</label>
                <button class="btn" style="background: #34495e; color: white; margin-bottom: 10px; width: 100%;" onclick="exportarBackup()">üì§ Exportar Backup (JSON)</button>
                <input type="file" id="import-file" style="display: none;" accept=".json" onchange="importarBackup(event)">
                <button class="btn btn-cancel" style="width: 100%;" onclick="document.getElementById('import-file').click()">üìÇ Importar Backup</button>
            </div>
            <div class="card" id="area-admin-usuarios" style="margin-top:20px; border: 1px solid #2e7d32;">
    <h3>üë• Cadastrar Novo Usu√°rio</h3>
    <input type="text" id="novo-user-nome" placeholder="Nome do Usu√°rio" style="width:100%; margin-bottom:10px; padding:8px;">
    <input type="password" id="novo-user-senha" placeholder="Senha" style="width:100%; margin-bottom:10px; padding:8px;">
    
    <label>Permitir acesso √†s abas:</label>
    <div style="text-align:left; margin:10px 0;">
        <input type="checkbox" class="perm-check" value="dash"> Dashboard <br>
        <input type="checkbox" class="perm-check" value="lista"> Entrada <br>
        <input type="checkbox" class="perm-check" value="estoque"> Estoque <br>
        <input type="checkbox" class="perm-check" value="vendas"> Vendas
    </div>

    <button class="btn btn-save" onclick="prepararCadastro()">Salvar Novo Usu√°rio</button>
</div>

<button class="btn btn-cancel" onclick="efetuarLogout()" style="margin-top:20px; width:100%;">Encerrar Sess√£o (Logout)</button>
        </section>
    </main>

    <nav class="bottom-nav">
        <button class="nav-item active" onclick="showScreen('dash', this)"><i>üìä</i><span>Dash</span></button>
        <button class="nav-item" onclick="showScreen('lista', this)"><i>üìù</i><span>Entrada</span></button>
        <button class="nav-item" onclick="showScreen('estoque', this)"><i>üì¶</i><span>Estoque</span></button>
        <button class="nav-item" onclick="showScreen('vendas', this)"><i>üí∞</i><span>Vendas</span></button>
        <button class="nav-item" onclick="showScreen('config', this)"><i>‚öôÔ∏è</i><span>Config</span></button>
    </nav>

    <script src="script.js"></script>
</body>
</html>
